# 추가로 작품 넣을 때 할 일

- **평소**: 매주/매일은 Vercel Cron이 알아서 `sync-weekly-ranking`, `sync-videos` 등을 호출한다. 따로 호출할 필요 없음.

---

## 1. 작품을 새로 추가하고 싶을 때

**POST** `https://ottsak.com/api/cron/import-works`

| 항목 | 값 |
|------|-----|
| **Header** | `X-Cron-Secret`: (CRON_SECRET 값) |
| **Header** | `Content-Type`: `application/json` |
| **Body** | `{ "titles": [ "기묘한 이야기 5", "오징어 게임 2" ] }` |

---

## 2. 특정 작품에 유튜브 예고편 1개 고정으로 넣고 싶을 때 (공식 예고편이 자동으로 안 잡힐 때)

**PATCH** `https://ottsak.com/api/admin/works/작품slug/manual-videos`

예: `/api/admin/works/stranger-things-66732/manual-videos` (기묘한 이야기)

| 항목 | 값 |
|------|-----|
| **Header** | `X-Cron-Secret`: (CRON_SECRET 값) 또는 `Authorization: Bearer (CRON_SECRET)` |
| **Header** | `Content-Type`: `application/json` |
| **Body** | `{ "youtube_ids": [ "영상ID" ] }` (URL 전체도 가능) |

수동으로 넣은 예고편은 **공식 예고편** 자리에서 자동 수집 영상보다 우선 표시된다.

---

## 3. 특정 작품만 유튜브 영상 다시 가져오고 싶을 때

자동 sync 대상: **최근 30일 이내 추가된 작품** + **출시 예정 또는 최근 6개월 이내 출시된 작품** (예고편은 출시 몇 달 전부터 올라오므로). 그래도 특정 작품만 수동으로 다시 동기화하고 싶을 때 아래를 쓴다.

**GET** `https://ottsak.com/api/cron/sync-videos?work_slug=작품slug`

예: `https://ottsak.com/api/cron/sync-videos?work_slug=stranger-things-66732`

| 항목 | 값 |
|------|-----|
| **Header** | `X-Cron-Secret`: (CRON_SECRET 값) |

---

- CRON_SECRET은 Vercel 환경 변수에 설정한 값 사용.
- Postman 등에 요청 저장해 두고 필요할 때만 호출하면 됨.
